"use strict";(self["webpackChunkadmin_one_vue_tailwind"]=self["webpackChunkadmin_one_vue_tailwind"]||[]).push([[523],{9443:function(e,l,a){a.d(l,{r:function(){return t}});a(7658);function t(e,l){return e.reduce((function(e,a){return(e[a[l]]=e[a[l]]||[]).push(a),e}),{})}},5690:function(e,l,a){a.d(l,{Z:function(){return r}});a(7658);var t=a(6252),n=a(3577),i=a(2262);const u={class:"mb-6 last:mb-0"},s={key:0,class:"block font-bold mb-2"},o={key:1,class:"text-xs text-red-500 dark:text-red-400 mt-1"};var c={__name:"Field",props:{label:{type:String,default:null},help:{type:String,default:null}},setup(e){const l=(0,t.Rr)(),a=(0,t.Fl)((()=>{const e=[],a=l.default().length;return a>1&&e.push("grid grid-cols-1 gap-3"),2===a&&e.push("md:grid-cols-2"),e}));return(l,c)=>((0,t.wg)(),(0,t.iD)("div",u,[e.label?((0,t.wg)(),(0,t.iD)("label",s,(0,n.zw)(e.label),1)):(0,t.kq)("",!0),(0,t._)("div",{class:(0,n.C_)((0,i.SU)(a))},[(0,t.WI)(l.$slots,"default")],2),e.help?((0,t.wg)(),(0,t.iD)("div",o,(0,n.zw)(e.help[0].message),1)):(0,t.kq)("",!0)]))}};const m=c;var r=m},3523:function(e,l,a){a.r(l),a.d(l,{default:function(){return D}});a(7658);var t=a(6252),n=a(2262),i=a(3577),u=a(5317),s=a(7315),o=a(9890),c=a(5693),m=a(7877),r=a(3002),d=a(2201),p=a(5690),v=a(2213),w=a(1388),f=a(6373),g=a(9443);const h={class:"px-2 py-1"},k={class:""},b={class:"text-sm"},y=["onClick"],_={class:"text-gray-500"},Z={key:1,class:"bg-opacity-50 p-3 dark:bg-gray-800"};var W={__name:"MemoComments",setup(e){const l=(0,d.yj)(),a=(0,n.iH)({}),W=(0,n.iH)([]),x=(0,n.iH)([]),D=(0,n.iH)([]),C=(0,n.iH)([]),H=(0,n.iH)({}),U=(0,r.pm)(),z=(0,n.iH)(l.params.memoId),V=(0,n.iH)({}),$=(0,n.qj)({comment:"",recipients:null});function q(){const e=x.value.find((e=>e===H.value.id));e||(x.value.push(H.value.id),D.value.push({id:H.value.id,name:H.value.label}))}function S(e,l){const a=[];return e.forEach((e=>{e!==l&&e.id!==l&&a.push(e)})),a}function j(e){x.value=S(x.value,e),D.value=S(D.value,e)}async function M(e){try{const{data:l}=await m.Z.get(`/memos/${e}`);a.value=l,D.value=[],x.value=[],l.recipients.forEach((e=>{x.value.push(e.id),D.value.push({id:e.id,name:e.fullName})}))}catch(l){U.error(l.detail)}}async function E(){try{const{data:e}=await m.Z.get("/users");e.forEach((e=>{W.value.push({id:e.id,label:e.fullName})}))}catch(e){U.error(e.detail)}}function K(){V.value={}}async function N(){try{K(),$.recipients=x;const{message:e}=await m.Z.post(`/memos/${z.value}/comments`,$);U.success(e),await I(),F()}catch(e){e.errors?V.value=(0,g.r)(e.errors,"field"):U.error(e.detail)}}async function R(e){try{const{data:l}=await m.Z.get(`/memos/${e}/comments`);C.value=l}catch(l){U.error(l.detail)}}async function Y(e){try{const{message:l}=await m.Z["delete"](`/memos/${z.value}/comments/${e}`);U.success(l),await R(z.value)}catch(l){U.error(l.detail)}}function F(){$.comment=""}async function I(){await M(z.value),await R(z.value)}return(0,t.bv)((async()=>{await I(),E()})),(e,l)=>((0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(s.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(o.Z,{title:"Memo Details",icon:(0,n.SU)(u.hjO),form:""},{default:(0,t.w5)((()=>[D.value.length?((0,t.wg)(),(0,t.j4)(p.Z,{key:0,label:"Recipients"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.value,(e=>((0,t.wg)(),(0,t.iD)("span",{key:e.id,class:"inline-block px-2 py-1"},(0,i.zw)(e.name),1)))),128))])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(c.Z),(0,t.Wm)(p.Z,{label:"Memo Title"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(a.value.title),1)])),_:1}),(0,t.Wm)(c.Z),(0,t.Wm)(p.Z,{label:"Date"},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(a.value.date),1)])),_:1}),(0,t.Wm)(c.Z),(0,t.Wm)(p.Z,{label:"Memo Comments"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(C.value,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.id},[(0,t._)("div",h,[(0,t._)("div",k,[(0,t.Uk)((0,i.zw)(e.user.fullName)+" on ",1),(0,t._)("span",b,(0,i.zw)(e.date),1),(0,t.Uk)(),(0,t._)("button",{class:"inline-block bg-red-700 p-2 rounded-sm mr-2 text-white-700",onClick:l=>Y(e.id)}," X ",8,y)]),(0,t._)("div",_,(0,i.zw)(e.comment),1)])])))),128))])),_:1}),(0,t.Wm)(c.Z),(0,t.Wm)(p.Z,{label:"Recipient",help:V.value.recipients},{default:(0,t.w5)((()=>[(0,t.Wm)(v.Z,{modelValue:H.value,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value=e),options:W.value,onChange:q},null,8,["modelValue","options"])])),_:1},8,["help"]),D.value.length?((0,t.wg)(),(0,t.iD)("div",Z,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(D.value,(e=>((0,t.wg)(),(0,t.iD)("span",{key:e.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm dark:bg-gray-700 light:bg-gray-300"},[(0,t.Uk)((0,i.zw)(e.name)+" ",1),(0,t._)("span",null,[(0,t.Wm)(w.Z,{class:"inline-block bg-red-700 p-1 rounded-sm mr-2 text-white-700",onClick:l=>j(e.id)},{default:(0,t.w5)((()=>[(0,t.Uk)("X")])),_:2},1032,["onClick"])])])))),128))])):(0,t.kq)("",!0),(0,t.Wm)(c.Z),(0,t.Wm)(p.Z,{label:"Comment",help:V.value.comment},{default:(0,t.w5)((()=>[(0,t.Wm)(v.Z,{modelValue:$.comment,"onUpdate:modelValue":l[1]||(l[1]=e=>$.comment=e),row:"3",type:"textarea"},null,8,["modelValue"])])),_:1},8,["help"]),(0,t.Wm)(c.Z),(0,t.Wm)(f.Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(w.Z,{type:"submit",color:"info",label:"Send",onClick:N})])),_:1})])),_:1},8,["icon"])])),_:1})]))}};const x=W;var D=x}}]);
//# sourceMappingURL=523.219bc070.js.map