{"version":3,"file":"js/523.219bc070.js","mappings":"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","sources":["webpack://admin-one-vue-tailwind/./src/helpers/group-errors.js","webpack://admin-one-vue-tailwind/./src/components/Field.vue","webpack://admin-one-vue-tailwind/./src/components/Field.vue?7442","webpack://admin-one-vue-tailwind/./src/views/Memo/MemoComments.vue","webpack://admin-one-vue-tailwind/./src/views/Memo/MemoComments.vue?3b99"],"sourcesContent":["export function groupErrors (xs, key) {\n  return xs.reduce(function (rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x)\n    return rv\n  }, {})\n};\n","<script setup>\nimport { computed, useSlots } from 'vue'\n\ndefineProps({\n  label: {\n    type: String,\n    default: null\n  },\n  help: {\n    type: String,\n    default: null\n  }\n})\n\nconst slots = useSlots()\n\nconst wrapperClass = computed(() => {\n  const base = []\n  const slotsLength = slots.default().length\n\n  if (slotsLength > 1) {\n    base.push('grid grid-cols-1 gap-3')\n  }\n\n  if (slotsLength === 2) {\n    base.push('md:grid-cols-2')\n  }\n\n  return base\n})\n</script>\n\n<template>\n  <div class=\"mb-6 last:mb-0\">\n    <label\n      v-if=\"label\"\n      class=\"block font-bold mb-2\"\n    >{{ label }}</label>\n    <div :class=\"wrapperClass\">\n      <slot />\n    </div>\n    <div\n      v-if=\"help\"\n      class=\"text-xs text-red-500 dark:text-red-400 mt-1\"\n    >\n      {{ help[0].message }}\n    </div>\n  </div>\n</template>\n","import script from \"./Field.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Field.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<script setup>\nimport { ref, onMounted, reactive } from 'vue'\nimport { mdiBallot } from '@mdi/js'\nimport MainSection from '@/components/MainSection.vue'\nimport CardComponent from '@/components/CardComponent.vue'\nimport Divider from '@/components/Divider.vue'\nimport Api from '@/api'\nimport { useToast } from 'vue-toastification'\nimport { useRoute } from 'vue-router'\nimport Field from '@/components/Field.vue'\nimport Control from '@/components/Control.vue'\nimport JbButton from '@/components/JbButton.vue'\nimport JbButtons from '@/components/JbButtons.vue'\nimport { groupErrors } from '@/helpers'\n\nconst routes = useRoute()\nconst memo = ref({})\nconst users = ref([])\nconst selectedRecipients = ref([])\nconst displayedRecipients = ref([])\nconst memoComments = ref([])\nconst recipientSelectBox = ref({})\nconst toastMessage = useToast()\nconst memoId = ref(routes.params.memoId)\nconst errors = ref({})\n\nconst form = reactive({\n  comment: '',\n  recipients: null\n})\n\nfunction setRecipient () {\n  const isExist = selectedRecipients.value.find(id => id === recipientSelectBox.value.id)\n  if (!isExist) {\n    selectedRecipients.value.push(recipientSelectBox.value.id)\n    displayedRecipients.value.push({\n      id: recipientSelectBox.value.id,\n      name: recipientSelectBox.value.label\n    })\n  }\n}\nfunction deleteElementFromArray (array, key) {\n  const newArray = []\n  array.forEach(element => {\n    if ((element !== key) && (element.id !== key)) {\n      newArray.push(element)\n    }\n  })\n  return newArray\n}\nfunction removeSelectedRecipients (id) {\n  selectedRecipients.value = deleteElementFromArray(selectedRecipients.value, id)\n  displayedRecipients.value = deleteElementFromArray(displayedRecipients.value, id)\n}\nasync function getMemoDetails (memoId) {\n  try {\n    const { data } = await Api.get(`/memos/${memoId}`)\n    memo.value = data\n    displayedRecipients.value = []\n    selectedRecipients.value = []\n    data.recipients.forEach(recipient => {\n      selectedRecipients.value.push(recipient.id)\n      displayedRecipients.value.push({\n        id: recipient.id,\n        name: recipient.fullName\n      })\n    })\n  } catch (error) {\n    toastMessage.error(error.detail)\n  }\n}\nasync function getUsers () {\n  try {\n    const { data } = await Api.get('/users')\n    data.forEach(element => {\n      users.value.push({\n        id: element.id,\n        label: element.fullName\n      })\n    })\n  } catch (error) {\n    toastMessage.error(error.detail)\n  }\n}\nfunction clearErrors () {\n  errors.value = {}\n}\nasync function submitComment () {\n  try {\n    clearErrors()\n    form.recipients = selectedRecipients\n    const { message } = await Api.post(`/memos/${memoId.value}/comments`, form)\n\n    toastMessage.success(message)\n    await initializeData()\n    clearInputFields()\n  } catch (error) {\n    if (error.errors) {\n      errors.value = groupErrors(error.errors, 'field')\n    } else {\n      toastMessage.error(error.detail)\n    }\n  }\n}\nasync function getMemoComments (memoId) {\n  try {\n    const { data } = await Api.get(`/memos/${memoId}/comments`)\n    memoComments.value = data\n  } catch (error) {\n    toastMessage.error(error.detail)\n  }\n}\nasync function deleteMemoComment (id) {\n  try {\n    const { message } = await Api.delete(`/memos/${memoId.value}/comments/${id}`)\n    toastMessage.success(message)\n    await getMemoComments(memoId.value)\n  } catch (error) {\n    toastMessage.error(error.detail)\n  }\n}\nfunction clearInputFields () {\n  form.comment = ''\n}\nasync function initializeData () {\n  await getMemoDetails(memoId.value)\n  await getMemoComments(memoId.value)\n}\nonMounted(async () => {\n  await initializeData()\n  getUsers()\n})\n\n</script>\n<template>\n  <div>\n    <main-section>\n      <card-component\n        title=\"Memo Details\"\n        :icon=\"mdiBallot\"\n        form\n      >\n        <field\n          v-if=\"displayedRecipients.length\"\n          label=\"Recipients\"\n        >\n          <span\n            v-for=\"recipient in displayedRecipients\"\n            :key=\"recipient.id\"\n            class=\"inline-block px-2 py-1\"\n          >\n            {{ recipient.name }}\n          </span>\n        </field>\n        <divider />\n        <field label=\"Memo Title\">\n          {{ memo.title }}\n        </field>\n        <divider />\n        <field label=\"Date\">\n          {{ memo.date }}\n        </field>\n        <divider />\n        <field label=\"Memo Comments\">\n          <div\n            v-for=\"comment in memoComments\"\n            :key=\"comment.id\"\n          >\n            <div class=\"px-2 py-1\">\n              <div class=\"\">\n                {{ comment.user.fullName }} on <span class=\"text-sm\">{{ comment.date }}</span> <button\n                  class=\"inline-block bg-red-700 p-2 rounded-sm mr-2 text-white-700\"\n                  @click=\"deleteMemoComment(comment.id)\"\n                >\n                  X\n                </button>\n              </div>\n              <div class=\"text-gray-500\">\n                {{ comment.comment }}\n              </div>\n            </div>\n          </div>\n        </field>\n        <divider />\n        <field\n          label=\"Recipient\"\n          :help=\"errors.recipients\"\n        >\n          <control\n            v-model=\"recipientSelectBox\"\n            :options=\"users\"\n            @change=\"setRecipient\"\n          />\n        </field>\n        <div\n          v-if=\"displayedRecipients.length\"\n          class=\"bg-opacity-50 p-3 dark:bg-gray-800\"\n        >\n          <span\n            v-for=\"recipient in displayedRecipients\"\n            :key=\"recipient.id\"\n            class=\"inline-block px-2 py-1 rounded-sm mr-2 text-sm dark:bg-gray-700 light:bg-gray-300\"\n          >\n            {{ recipient.name }} <span><jb-button\n              class=\"inline-block bg-red-700 p-1 rounded-sm mr-2 text-white-700\"\n              @click=\"removeSelectedRecipients(recipient.id)\"\n            >X</jb-button></span>\n          </span>\n        </div>\n        <divider />\n        <field\n          label=\"Comment\"\n          :help=\"errors.comment\"\n        >\n          <control\n            v-model=\"form.comment\"\n            row=\"3\"\n            type=\"textarea\"\n          />\n        </field>\n        <divider />\n        <jb-buttons>\n          <jb-button\n            type=\"submit\"\n            color=\"info\"\n            label=\"Send\"\n            @click=\"submitComment\"\n          />\n        </jb-buttons>\n      </card-component>\n    </main-section>\n  </div>\n</template>\n","import script from \"./MemoComments.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./MemoComments.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["groupErrors","xs","key","reduce","rv","x","push","slots","useSlots","wrapperClass","computed","base","slotsLength","default","length","__exports__","routes","useRoute","memo","ref","users","selectedRecipients","displayedRecipients","memoComments","recipientSelectBox","toastMessage","useToast","memoId","params","errors","form","reactive","comment","recipients","setRecipient","isExist","value","find","id","name","label","deleteElementFromArray","array","newArray","forEach","element","removeSelectedRecipients","async","getMemoDetails","data","Api","recipient","fullName","error","detail","getUsers","clearErrors","submitComment","message","success","initializeData","clearInputFields","getMemoComments","deleteMemoComment","onMounted"],"sourceRoot":""}