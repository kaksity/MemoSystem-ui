"use strict";(self["webpackChunkadmin_one_vue_tailwind"]=self["webpackChunkadmin_one_vue_tailwind"]||[]).push([[318],{9443:function(e,t,l){l.d(t,{r:function(){return n}});l(7658);function n(e,t){return e.reduce((function(e,l){return(e[l[t]]=e[l[t]]||[]).push(l),e}),{})}},5690:function(e,t,l){l.d(t,{Z:function(){return c}});l(7658);var n=l(6252),a=l(3577),u=l(2262);const i={class:"mb-6 last:mb-0"},o={key:0,class:"block font-bold mb-2"},r={key:1,class:"text-xs text-red-500 dark:text-red-400 mt-1"};var d={__name:"Field",props:{label:{type:String,default:null},help:{type:String,default:null}},setup(e){const t=(0,n.Rr)(),l=(0,n.Fl)((()=>{const e=[],l=t.default().length;return l>1&&e.push("grid grid-cols-1 gap-3"),2===l&&e.push("md:grid-cols-2"),e}));return(t,d)=>((0,n.wg)(),(0,n.iD)("div",i,[e.label?((0,n.wg)(),(0,n.iD)("label",o,(0,a.zw)(e.label),1)):(0,n.kq)("",!0),(0,n._)("div",{class:(0,a.C_)((0,u.SU)(l))},[(0,n.WI)(t.$slots,"default")],2),e.help?((0,n.wg)(),(0,n.iD)("div",r,(0,a.zw)(e.help[0].message),1)):(0,n.kq)("",!0)]))}};const s=d;var c=s},7318:function(e,t,l){l.r(t),l.d(t,{default:function(){return _}});l(7658);var n=l(6252),a=l(2262),u=l(9963),i=l(3577),o=l(5317),r=l(7315),d=l(9890),s=l(5690),c=l(2213),m=l(5693),p=l(1388),v=l(6373),f=l(7877),h=l(3002),g=l(2201),w=l(9443);const b={key:0,class:"bg-opacity-50 p-3 dark:bg-gray-800"};var y={__name:"EditMemo",setup(e){const t=(0,g.yj)(),l=(0,a.iH)([]),y=(0,a.iH)(null),k=(0,h.pm)(),_=(0,a.iH)({}),Z=(0,a.iH)(t.params.memoId),W=(0,a.iH)([]),D=(0,a.iH)([]),S=(0,a.iH)({}),H=(0,a.qj)({recipients:null,content:"",title:"",date:(new Date).toString()});async function V(e){try{const{data:t}=await f.Z.get(`/memos/${e}`);H.title=t.title,H.date=t.date,H.content=t.content,y.value.setHTML(H.content),t.recipients.forEach((e=>{W.value.push(e.id),D.value.push({id:e.id,name:e.fullName})}))}catch(t){k.error(t.message)}}function U(){const e=W.value.find((e=>e===S.value.id));e||(W.value.push(S.value.id),D.value.push({id:S.value.id,name:S.value.label}))}function x(e){W.value=C(W.value,e),D.value=C(D.value,e)}function C(e,t){const l=[];return e.forEach((e=>{e!==t&&e.id!==t&&l.push(e)})),l}async function E(){try{const{data:e}=await f.Z.get("/users");e.forEach((e=>{l.value.push({id:e.id,label:e.fullName})}))}catch(e){k.error(e.detail)}}function M(e){return new Date(e).toISOString().split("T")[0]}async function q(){_.value={}}(0,n.bv)((async()=>{await E(),await V(Z.value)}));const j=async()=>{try{q();const e=await f.Z.put(`/memos/${Z.value}`,{recipients:W.value,content:H.content,title:H.title,date:M(H.date)});k.success(e.message)}catch(e){e.errors?_.value=(0,w.r)(e.errors,"field"):k.error(e.detail)}};return(e,t)=>{const f=(0,n.up)("datepicker"),h=(0,n.up)("QuillEditor");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(r.Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d.Z,{title:"Edit Memo",icon:(0,a.SU)(o.hjO),form:"",onSubmit:(0,u.iM)(j,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Wm)(s.Z,{label:"Recipient",help:_.value.recipients},{default:(0,n.w5)((()=>[(0,n.Wm)(c.Z,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),options:l.value,onChange:U},null,8,["modelValue","options"])])),_:1},8,["help"]),D.value.length?((0,n.wg)(),(0,n.iD)("div",b,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(D.value,(e=>((0,n.wg)(),(0,n.iD)("span",{key:e.id,class:"inline-block px-2 py-1 rounded-sm mr-2 text-sm dark:bg-gray-700 light:bg-gray-300"},[(0,n.Uk)((0,i.zw)(e.name)+" ",1),(0,n._)("span",null,[(0,n.Wm)(p.Z,{class:"inline-block bg-red-700 p-1 rounded-sm mr-2 text-white-700",onClick:t=>x(e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)("X")])),_:2},1032,["onClick"])])])))),128))])):(0,n.kq)("",!0),(0,n.Wm)(m.Z),(0,n.Wm)(s.Z,{label:"Memo Title",help:_.value.title},{default:(0,n.w5)((()=>[(0,n.Wm)(c.Z,{modelValue:H.title,"onUpdate:modelValue":t[1]||(t[1]=e=>H.title=e)},null,8,["modelValue"])])),_:1},8,["help"]),(0,n.Wm)(m.Z),(0,n.Wm)(s.Z,{label:"Date",help:_.value.date},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{modelValue:H.date,"onUpdate:modelValue":t[2]||(t[2]=e=>H.date=e),"auto-apply":"","alt-position":""},null,8,["modelValue"])])),_:1},8,["help"]),(0,n.Wm)(m.Z),(0,n.Wm)(s.Z,{label:"Memo Content",help:_.value.content},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{ref_key:"editor",ref:y,content:H.content,"onUpdate:content":t[3]||(t[3]=e=>H.content=e),theme:"snow","content-type":"html",toolbar:"full"},null,8,["content"])])),_:1},8,["help"]),(0,n.Wm)(m.Z),(0,n.Wm)(v.Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p.Z,{type:"submit",color:"info",label:"Send"})])),_:1})])),_:1},8,["icon","onSubmit"])])),_:1})])}}};const k=y;var _=k}}]);
//# sourceMappingURL=318.667756a9.js.map