{"version":3,"file":"js/362.e5fbdd93.js","mappings":"mLAAO,SAASA,EAAaC,EAAIC,GAC/B,OAAOD,EAAGE,QAAO,SAAUC,EAAIC,GAE7B,OADCD,EAAGC,EAAEH,IAAQE,EAAGC,EAAEH,KAAS,IAAII,KAAKD,GAC9BD,CACT,GAAG,CAAC,EACN,C,+UCSA,MAAMG,GAAQC,EAAAA,EAAAA,MAERC,GAAeC,EAAAA,EAAAA,KAAS,KAC5B,MAAMC,EAAO,GACPC,EAAcL,EAAMM,UAAUC,OAUpC,OARIF,EAAc,GAChBD,EAAKL,KAAK,0BAGQ,IAAhBM,GACFD,EAAKL,KAAK,kBAGLK,CAAI,I,+RCzBb,MAAMI,EAAc,EAEpB,O,4UCWA,MAAMC,GAASC,EAAAA,EAAAA,MACTC,GAAaC,EAAAA,EAAAA,IAAI,IACjBC,GAASD,EAAAA,EAAAA,IAAI,MACbE,GAAeC,EAAAA,EAAAA,MACfC,GAASJ,EAAAA,EAAAA,IAAI,CAAC,GACdK,GAASL,EAAAA,EAAAA,IAAIH,EAAOS,OAAOD,QAE3BE,GAAqBP,EAAAA,EAAAA,IAAI,IACzBQ,GAAsBR,EAAAA,EAAAA,IAAI,IAC1BS,GAAqBT,EAAAA,EAAAA,IAAI,CAAC,GAC1BU,GAAOC,EAAAA,EAAAA,IAAS,CACpBZ,WAAY,KACZa,QAAS,GACTC,MAAO,GACPC,MAAM,IAAIC,MAAOC,aAGnBC,eAAeC,EAAgBb,GAC7B,IACE,MAAM,KAAEc,SAAeC,EAAAA,EAAAA,IAAS,UAASf,KAEzCK,EAAKG,MAAQM,EAAKN,MAClBH,EAAKI,KAAOK,EAAKL,KACjBJ,EAAKE,QAAUO,EAAKP,QACpBX,EAAOoB,MAAMC,QAAQZ,EAAKE,SAE1BO,EAAKpB,WAAWwB,SAAQC,IACtBjB,EAAmBc,MAAMlC,KAAKqC,EAAUC,IACxCjB,EAAoBa,MAAMlC,KAAK,CAC7BsC,GAAID,EAAUC,GACdC,KAAMF,EAAUG,UAChB,GAIN,CAFE,MAAOC,GACP1B,EAAa0B,MAAMA,EAAMC,QAC3B,CACF,CAEA,SAASC,IACPvB,EAAmBc,MAAQ,GAC3Bb,EAAoBa,MAAQ,GAC5BX,EAAKE,QAAU,GACfF,EAAKI,MAAO,IAAIC,MAAOC,WACvBN,EAAKG,MAAQ,GACbZ,EAAOoB,MAAMC,QAAQZ,EAAKE,QAC5B,CAOA,SAASmB,IACP,MAAMC,EAAUzB,EAAmBc,MAAMY,MAAKR,GAAMA,IAAOhB,EAAmBY,MAAMI,KAC/EO,IACHzB,EAAmBc,MAAMlC,KAAKsB,EAAmBY,MAAMI,IACvDjB,EAAoBa,MAAMlC,KAAK,CAC7BsC,GAAIhB,EAAmBY,MAAMI,GAC7BC,KAAMjB,EAAmBY,MAAMa,QAGrC,CACA,SAASC,EAA0BV,GACjClB,EAAmBc,MAAQe,EAAuB7B,EAAmBc,MAAOI,GAC5EjB,EAAoBa,MAAQe,EAAuB5B,EAAoBa,MAAOI,EAChF,CACA,SAASW,EAAwBC,EAAOtD,GACtC,MAAMuD,EAAW,GAMjB,OALAD,EAAMd,SAAQgB,IACPA,IAAYxD,GAASwD,EAAQd,KAAO1C,GACvCuD,EAASnD,KAAKoD,EAChB,IAEKD,CACT,CAEArB,eAAeuB,IACb,IACE,MAAM,KAAErB,SAAeC,EAAAA,EAAAA,IAAQ,UAC/BD,EAAKI,SAAQgB,IACXxC,EAAWsB,MAAMlC,KAAK,CACpBsC,GAAIc,EAAQd,GACZS,MAAOK,EAAQZ,UACf,GAIN,CAFE,MAAOC,GACP1B,EAAa0B,MAAMA,EAAMa,OAC3B,CACF,CAEA,SAASC,EAAiBC,GACxB,OAAO,IAAI5B,KAAK4B,GAAOC,cAAcC,MAAM,KAAK,EAClD,CAEA5B,eAAe6B,IACb1C,EAAOiB,MAAQ,CAAC,CAClB,EAjDA0B,EAAAA,EAAAA,KAAU9B,gBACFuB,UACAtB,EAAeb,EAAOgB,MAAM,IAgDpC,MAAM2B,EAAS/B,UACb,IACE6B,IACA,MAAMG,QAAiB7B,EAAAA,EAAAA,IAAS,UAASf,EAAOgB,QAAS,CACvDtB,WAAYQ,EAAmBc,MAC/BT,QAASF,EAAKE,QACdC,MAAOH,EAAKG,MACZC,KAAM4B,EAAgBhC,EAAKI,QAE7BZ,EAAagD,QAAQD,EAASpB,SAC9BC,GAOF,CANE,MAAOF,GACHA,EAAMxB,OACRA,EAAOiB,OAAQxC,EAAAA,EAAAA,GAAY+C,EAAMxB,OAAQ,SAEzCF,EAAa0B,MAAMA,EAAMa,OAE7B,G,42DC/HF,MAAM7C,EAAc,EAEpB,O","sources":["webpack://admin-one-vue-tailwind/./src/helpers/group-errors.js","webpack://admin-one-vue-tailwind/./src/components/Field.vue","webpack://admin-one-vue-tailwind/./src/components/Field.vue?7442","webpack://admin-one-vue-tailwind/./src/views/CouncilMemo/EditMemo.vue","webpack://admin-one-vue-tailwind/./src/views/CouncilMemo/EditMemo.vue?007b"],"sourcesContent":["export function groupErrors (xs, key) {\n  return xs.reduce(function (rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x)\n    return rv\n  }, {})\n};\n","<script setup>\nimport { computed, useSlots } from 'vue'\n\ndefineProps({\n  label: {\n    type: String,\n    default: null\n  },\n  help: {\n    type: String,\n    default: null\n  }\n})\n\nconst slots = useSlots()\n\nconst wrapperClass = computed(() => {\n  const base = []\n  const slotsLength = slots.default().length\n\n  if (slotsLength > 1) {\n    base.push('grid grid-cols-1 gap-3')\n  }\n\n  if (slotsLength === 2) {\n    base.push('md:grid-cols-2')\n  }\n\n  return base\n})\n</script>\n\n<template>\n  <div class=\"mb-6 last:mb-0\">\n    <label\n      v-if=\"label\"\n      class=\"block font-bold mb-2\"\n    >{{ label }}</label>\n    <div :class=\"wrapperClass\">\n      <slot />\n    </div>\n    <div\n      v-if=\"help\"\n      class=\"text-xs text-red-500 dark:text-red-400 mt-1\"\n    >\n      {{ help[0].message }}\n    </div>\n  </div>\n</template>\n","import script from \"./Field.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Field.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<script setup>\nimport { reactive, ref, onMounted } from 'vue'\nimport { mdiBallot } from '@mdi/js'\nimport MainSection from '@/components/MainSection.vue'\nimport CardComponent from '@/components/CardComponent.vue'\nimport Field from '@/components/Field.vue'\nimport Control from '@/components/Control.vue'\nimport Divider from '@/components/Divider.vue'\nimport JbButton from '@/components/JbButton.vue'\nimport JbButtons from '@/components/JbButtons.vue'\nimport Api from '@/api'\nimport { useToast } from 'vue-toastification'\nimport { useRoute } from 'vue-router'\nimport { groupErrors } from '@/helpers'\n\n// const recipients = ref([])\nconst routes = useRoute()\nconst recipients = ref([])\nconst editor = ref(null)\nconst toastMessage = useToast()\nconst errors = ref({})\nconst memoId = ref(routes.params.memoId)\n\nconst selectedRecipients = ref([])\nconst displayedRecipients = ref([])\nconst recipientSelectBox = ref({})\nconst form = reactive({\n  recipients: null,\n  content: '',\n  title: '',\n  date: new Date().toString()\n})\n\nasync function getMemoDetails (memoId) {\n  try {\n    const { data } = await Api.get(`/memos/${memoId}`)\n\n    form.title = data.title\n    form.date = data.date\n    form.content = data.content\n    editor.value.setHTML(form.content)\n\n    data.recipients.forEach(recipient => {\n      selectedRecipients.value.push(recipient.id)\n      displayedRecipients.value.push({\n        id: recipient.id,\n        name: recipient.fullName\n      })\n    })\n  } catch (error) {\n    toastMessage.error(error.message)\n  }\n}\n\nfunction clearInputs () {\n  selectedRecipients.value = []\n  displayedRecipients.value = []\n  form.content = ''\n  form.date = new Date().toString()\n  form.title = ''\n  editor.value.setHTML(form.content)\n}\n\nonMounted(async () => {\n  await getUsers()\n  await getMemoDetails(memoId.value)\n})\n\nfunction setRecipient () {\n  const isExist = selectedRecipients.value.find(id => id === recipientSelectBox.value.id)\n  if (!isExist) {\n    selectedRecipients.value.push(recipientSelectBox.value.id)\n    displayedRecipients.value.push({\n      id: recipientSelectBox.value.id,\n      name: recipientSelectBox.value.label\n    })\n  }\n}\nfunction removeSelectedRecipients (id) {\n  selectedRecipients.value = deleteElementFromArray(selectedRecipients.value, id)\n  displayedRecipients.value = deleteElementFromArray(displayedRecipients.value, id)\n}\nfunction deleteElementFromArray (array, key) {\n  const newArray = []\n  array.forEach(element => {\n    if ((element !== key) && (element.id !== key)) {\n      newArray.push(element)\n    }\n  })\n  return newArray\n}\n\nasync function getUsers () {\n  try {\n    const { data } = await Api.get('/users')\n    data.forEach(element => {\n      recipients.value.push({\n        id: element.id,\n        label: element.fullName\n      })\n    })\n  } catch (error) {\n    toastMessage.error(error.detail)\n  }\n}\n\nfunction processDateTime (input) {\n  return new Date(input).toISOString().split('T')[0]\n}\n\nasync function clearErrors () {\n  errors.value = {}\n}\nconst submit = async () => {\n  try {\n    clearErrors()\n    const response = await Api.put(`/memos/${memoId.value}`, {\n      recipients: selectedRecipients.value,\n      content: form.content,\n      title: form.title,\n      date: processDateTime(form.date)\n    })\n    toastMessage.success(response.message)\n    clearInputs()\n  } catch (error) {\n    if (error.errors) {\n      errors.value = groupErrors(error.errors, 'field')\n    } else {\n      toastMessage.error(error.detail)\n    }\n  }\n}\n</script>\n<template>\n  <div>\n    <main-section>\n      <card-component\n        title=\"Edit Memo\"\n        :icon=\"mdiBallot\"\n        form\n        @submit.prevent=\"submit\"\n      >\n        <field\n          label=\"Recipient\"\n          :help=\"errors.recipients\"\n        >\n          <control\n            v-model=\"recipientSelectBox\"\n            :options=\"recipients\"\n            @change=\"setRecipient\"\n          />\n        </field>\n        <div\n          v-if=\"displayedRecipients.length\"\n          class=\"bg-opacity-50 p-3 dark:bg-gray-800\"\n        >\n          <span\n            v-for=\"recipient in displayedRecipients\"\n            :key=\"recipient.id\"\n            class=\"inline-block px-2 py-1 rounded-sm mr-2 text-sm dark:bg-gray-700 light:bg-gray-300\"\n          >\n            {{ recipient.name }} <span><JbButton\n              class=\"inline-block bg-red-700 p-1 rounded-sm mr-2 text-white-700\"\n              @click=\"removeSelectedRecipients(recipient.id)\"\n            >X</JbButton></span>\n          </span>\n        </div>\n        <divider />\n        <field\n          label=\"Memo Title\"\n          :help=\"errors.title\"\n        >\n          <control\n            v-model=\"form.title\"\n          />\n        </field>\n        <divider />\n        <field\n          label=\"Date\"\n          :help=\"errors.date\"\n        >\n          <datepicker\n            v-model=\"form.date\"\n            auto-apply\n            alt-position\n          />\n        </field>\n        <divider />\n        <field\n          label=\"Memo Content\"\n          :help=\"errors.content\"\n        >\n          <QuillEditor\n            ref=\"editor\"\n            v-model:content=\"form.content\"\n            theme=\"snow\"\n            content-type=\"html\"\n            toolbar=\"full\"\n          />\n        </field>\n        <divider />\n        <jb-buttons>\n          <jb-button\n            type=\"submit\"\n            color=\"info\"\n            label=\"Send\"\n          />\n        </jb-buttons>\n      </card-component>\n    </main-section>\n  </div>\n</template>\n","import script from \"./EditMemo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EditMemo.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["groupErrors","xs","key","reduce","rv","x","push","slots","useSlots","wrapperClass","computed","base","slotsLength","default","length","__exports__","routes","useRoute","recipients","ref","editor","toastMessage","useToast","errors","memoId","params","selectedRecipients","displayedRecipients","recipientSelectBox","form","reactive","content","title","date","Date","toString","async","getMemoDetails","data","Api","value","setHTML","forEach","recipient","id","name","fullName","error","message","clearInputs","setRecipient","isExist","find","label","removeSelectedRecipients","deleteElementFromArray","array","newArray","element","getUsers","detail","processDateTime","input","toISOString","split","clearErrors","onMounted","submit","response","success"],"sourceRoot":""}